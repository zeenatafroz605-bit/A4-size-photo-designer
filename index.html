<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A4 Photo Designer</title>
<style>
  body { font-family: sans-serif; margin:0; padding:0; display:flex; flex-direction:column; align-items:center; background:#f0f0f0; }
  #editor { border:2px solid #333; width: 210mm; height: 297mm; background:white; margin:20px 0; position:relative; }
  .draggable { position:absolute; cursor:move; }
  input, button { margin:5px; }
</style>
</head>
<body>
<h2>A4 Photo Designer</h2>
<input type="file" id="imgUpload">
<button id="addText">Add Text</button>
<button id="download">Download PDF</button>
<div id="editor"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const editor = document.getElementById('editor');

// Image upload
document.getElementById('imgUpload').addEventListener('change', function(e){
  const file = e.target.files[0];
  const reader = new FileReader();
  reader.onload = function(ev){
    const img = document.createElement('img');
    img.src = ev.target.result;
    img.className = 'draggable';
    img.style.top = '50px';
    img.style.left = '50px';
    img.style.width = '150px';
    img.style.height = '150px';
    makeDraggable(img);
    editor.appendChild(img);
  }
  reader.readAsDataURL(file);
});

// Add text
document.getElementById('addText').addEventListener('click', ()=>{
  const txt = prompt("Enter text:");
  if(txt){
    const div = document.createElement('div');
    div.innerText = txt;
    div.className = 'draggable';
    div.style.top = '50px';
    div.style.left = '50px';
    div.style.fontSize = '24px';
    makeDraggable(div);
    editor.appendChild(div);
  }
});

// Draggable function
function makeDraggable(el){
  let offsetX, offsetY, isDown=false;
  el.addEventListener('mousedown', e=>{
    isDown=true;
    offsetX = e.offsetX;
    offsetY = e.offsetY;
  });
  document.addEventListener('mousemove', e=>{
    if(isDown){
      el.style.left = (e.pageX - editor.offsetLeft - offsetX) + 'px';
      el.style.top = (e.pageY - editor.offsetTop - offsetY) + 'px';
    }
  });
  document.addEventListener('mouseup', ()=>{ isDown=false; });
}

// Download as PDF
document.getElementById('download').addEventListener('click', ()=>{
  html2canvas(editor).then(canvas=>{
    const imgData = canvas.toDataURL('image/png');
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({unit:'mm', format:'a4'});
    pdf.addImage(imgData, 'PNG', 0, 0, 210, 297);
    pdf.save('A4_Design.pdf');
  });
});
</script>
</body>
</html>
